<% content_for :menu do %>
  <li><a href="/">Home</a></li>
  <% unless authorised?("collect-csos") %>
  <li id="active"><a href="/regions">Addresses</a></li>
  <% end %>
  <% if authorised?("collect-admins") %>
    <li><a href="/manage">Manage</a></li>
  <% end %>
<% end %>

<% content_for :breadcrumbs do %>
  <a href="/regions">Regions</a> &gt; <a href="/regions/<%=h region_code %>/las">Region <%=h region_code %></a> &gt; <a href="/regions/<%=h region_code %>/las/<%=h local_authority_code %>/msoas">LA <%=h local_authority_code %></a> &gt; MSOA <%=h msoa_code %>
<% end %>

<% content_for :sub_heading do %>
  Click an Address ID to view questionnaires for that address.
<% end %>

<% if params[:page].present? %><a href="/regions/<%=h region_code %>/las/<%=h local_authority_code %>/msoas/<%=h msoa_code %>/addresses?page=<%=h params[:page] %>"><% else %><a href="/regions/<%=h region_code %>/las/<%=h local_authority_code %>/msoas/<%=h msoa_code %>/addresses"><% end %>Refresh</a>

<% if addresses.any? %>
<%= will_paginate addresses, :previous_label => '&lt; Prev', :next_label => 'Next &gt;' %>
<% addresses.each do |address| %>
  <table class="address">
    <thead>
      <tr>
        <th>UPRN</th>
        <th>Address Type</th>
        <th>Establishment Type</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a href="/regions/<%=h region_code %>/las/<%=h local_authority_code %>/msoas/<%=h msoa_code %>/addresses/<%=h address['uprn'] %>/cases"><%=h address['uprn'] %></a></td>
      <% if address['addressType'].present? %>
        <td><%=h address['addressType'].to_address_type %></td>
      <% else %>
        <td>-</td>
      <% end %>
      <% if address['estabType'].present? %>
        <td><%=h address['estabType'] %></td>
      <% else %>
        <td>-</td>
      <% end %>
        <td><% if params[:page].present? %><a href="/regions/<%=h region_code %>/las/<%=h local_authority_code %>/msoas/<%= msoa_code %>/addresses/<%=h address['uprn'] %>/edit?page=<%=h params[:page] %>"><% else %><a href="/regions/<%=h region_code %>/las/<%=h local_authority_code %>/msoas/<%= msoa_code %>/addresses/<%=h address['uprn'] %>/edit"><% end %>Edit</a></td>
      </tr>
    </tbody>
    <%= erb :addresslines_partial, locals: { address: address } %>
  </table>
<% end %>
<%= will_paginate addresses, :previous_label => '&lt; Prev', :next_label => 'Next &gt;' %>
<% else %>
  <p id="information"><strong>There are no addresses for this MSOA.</strong></p>
<% end %>

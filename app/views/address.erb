<% content_for :menu do %>
  <li><a href="/">Home</a></li>
  <li id="active"><a href="/regions">Addresses</a></li>
<% if authorised? %>
  <li><a href="/manage">Manage</a></li>
<% end %>
<% end %>

<% content_for :breadcrumbs do %>
  <a href="/regions">Regions</a> &gt; <a href="/regions/<%=h region_code %>/las">Region <%=h region_code %></a> &gt; <a href="/regions/<%=h region_code %>/las/<%=h local_authority_code %>/caseloads">LA <%=h local_authority_code %></a> &gt; <a href="/regions/<%=h region_code %>/las/<%=h local_authority_code %>/caseloads/<%=h caseload_code %>/addresses">Caseload <%=h caseload_code %></a> &gt; <% if method.eql? :post %>Create Address<% elsif method.eql? :put %>Edit Address<% end %>
<% end %>

<% content_for :javascript do %>
  <script src="/javascripts/address.js" type="text/javascript"></script>
<% end %>

<% if form.failed_on? :addgridref %>
  <% content_for :form_errors do %>
    <p class="message">&bull; Grid reference is required and must be a 13 character number</p>
  <% end %>
<% end %>

<% if form.failed_on? :enumerationtype %>
  <% content_for :form_errors do %>
    <p class="message">&bull; Enumeration type is required and must be a number</p>
  <% end %>
<% end %>

<% if form.failed_on? :estabtype %>
  <% content_for :form_errors do %>
    <p class="message">&bull; Establishment type is required for communal establishments and must be a number</p>
  <% end %>
<% end %>

<% if form.failed_on? :postcode %>
  <% content_for :form_errors do %>
    <p class="message">&bull; Postcode is required</p>
  <% end %>
<% end %>

<form action="<%= action %>" method="post">
<% if method.present? %>
  <input type="hidden" name="_method" value="<%= method %>">
<% end %>
<% if params[:page].present? %>
  <input type="hidden" name="page" value="<%=h params[:page] %>">
<% end %>
<%= erb :addressform_partial, locals: { addresstype: addresstype, buildingname: buildingname, addgridref: addgridref, subbuildingname: subbuildingname, enumerationtype: enumerationtype,
                                        buildingnumber: buildingnumber, estabtype: estabtype, thoroughfarename: thoroughfarename, hardtocount: hardtocount, posttown: posttown,
                                        estabname: estabname, postcode: postcode, namemanager: namemanager, telnumber: telnumber } %>
  <p id="requiredfields"><span class="required">*</span> Required fields</p>
  <p class="buttons">
    <input class="button" type="submit" value="Save"> or <% if params[:page].present? %><a href="/regions/<%=h region_code %>/las/<%=h local_authority_code %>/caseloads/<%=h caseload_code %>/addresses?page=<%=h params[:page] %>"><% else %><a href="/regions/<%=h region_code %>/las/<%=h local_authority_code %>/caseloads/<%=h caseload_code %>/addresses"><% end %>Cancel</a>
  </p>
</form>
